<!DOCTYPE html>
<html lang="en" class="admin-page">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Support Ticket Detail | African Deals Domain</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
  <link href="admin-input-fix.css" rel="stylesheet">
</head>
<body class="bg-gray-50">
    <!-- Header -->
    <header class="bg-gradient-to-r from-blue-600 to-purple-600 text-white shadow-lg">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <div class="w-10 h-10 bg-white bg-opacity-20 rounded-full flex items-center justify-center">
                        <i class="fas fa-headset text-xl"></i>
                    </div>
                    <div>
                        <h1 class="text-2xl font-bold">African Deals Domain</h1>
                        <p class="text-sm opacity-90">Admin Dashboard</p>
                    </div>
                </div>
                <div class="flex items-center space-x-4">
                    <div class="relative">
                        <button class="p-2 rounded-full bg-white bg-opacity-20 hover:bg-opacity-30 transition-all" onclick="showNotification('Feature in development', 'info')">
                            i class="fas fa-bell"></i>
                        </button>
                        <span class="absolute -top-1 -right-1 w-3 h-3 bg-red-500 rounded-full"></span>
                    </div>
                    <div class="flex items-center space-x-2">
                        <img src="https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?w=40&h=40&fit=crop&crop=face" 
                             alt="Admin" class="w-8 h-8 rounded-full">
                        <span class="font-medium">Admin</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <div class="flex">
        <!-- Sidebar -->
        <aside class="w-64 bg-white shadow-lg min-h-screen">
            <nav class="p-6">
                <div class="space-y-2">
                    <a href="../dashboard.html" class="flex items-center px-4 py-3 text-gray-700 rounded-lg hover:bg-blue-50 hover:text-blue-600 transition-all">
                        <i class="fas fa-tachometer-alt mr-3"></i>
                        Dashboard
                    </a>
                    <a href="../user-management.html" class="flex items-center px-4 py-3 text-gray-700 rounded-lg hover:bg-blue-50 hover:text-blue-600 transition-all">
                        <i class="fas fa-users mr-3"></i>
                        Users
                    </a>
                    <a href="../products.html" class="flex items-center px-4 py-3 text-gray-700 rounded-lg hover:bg-blue-50 hover:text-blue-600 transition-all">
                        <i class="fas fa-box mr-3"></i>
                        Products
                    </a>
                    <a href="../orders.html" class="flex items-center px-4 py-3 text-gray-700 rounded-lg hover:bg-blue-50 hover:text-blue-600 transition-all">
                        <i class="fas fa-shopping-cart mr-3"></i>
                        Orders
                    </a>
                    <a href="../support-tickets.html" class="flex items-center px-4 py-3 bg-blue-50 text-blue-600 rounded-lg border-r-4 border-blue-600">
                        <i class="fas fa-headset mr-3"></i>
                        Support
                    </a>
                    <a href="../system-errors/system-errors.html" class="flex items-center px-4 py-3 text-gray-700 rounded-lg hover:bg-blue-50 hover:text-blue-600 transition-all">
                        <i class="fas fa-exclamation-triangle mr-3"></i>
                        System Errors
                    </a>
                    <a href="../settings.html" class="flex items-center px-4 py-3 text-gray-700 rounded-lg hover:bg-blue-50 hover:text-blue-600 transition-all">
                        <i class="fas fa-cog mr-3"></i>
                        Settings
                    </a>
                </div>
            </nav>
        </aside>

        <!-- Main Content Area -->
        <main class="flex-1 p-8">
            <!-- Breadcrumb -->
            <div class="mb-6">
                <nav class="flex" aria-label="Breadcrumb">
                    <ol class="inline-flex items-center space-x-1 md:space-x-3">
                        <li class="inline-flex items-center">
                            <a href="../support-tickets.html" class="inline-flex items-center text-sm font-medium text-gray-700 hover:text-blue-600">
                                <i class="fas fa-headset mr-2"></i>
                                Support Tickets
                            </a>
                        </li>
                        <li>
                            <div class="flex items-center">
                                <i class="fas fa-chevron-right text-gray-400 mx-2"></i>
                                <span class="text-sm font-medium text-gray-500">Ticket Detail</span>
                            </div>
                        </li>
                    </ol>
                </nav>
            </div>

            <!-- Ticket Header -->
            <div class="bg-white rounded-xl shadow-lg p-6 mb-6">
                <div class="flex items-center justify-between mb-4">
                    <div>
                        <h2 class="text-2xl font-bold text-gray-900" id="ticketSubject">Payment Issue - Order #12345</h2>
                        <p class="text-gray-600">Ticket #TKT-001</p>
                    </div>
                    <div class="flex items-center space-x-3">
                        <span class="px-3 py-1 text-sm font-semibold rounded-full bg-yellow-100 text-yellow-800" id="ticketStatus">Open</span>
                        <span class="px-3 py-1 text-sm font-semibold rounded-full bg-red-100 text-red-800" id="ticketPriority">High</span>
                    </div>
                </div>
                
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4 text-sm">
                    <div>
                        <span class="font-medium text-gray-700">Customer:</span>
                        <span class="ml-2 text-gray-900" id="customerName">John Doe</span>
                    </div>
                    <div>
                        <span class="font-medium text-gray-700">Email:</span>
                        <span class="ml-2 text-gray-900" id="customerEmail">john@example.com</span>
                    </div>
                    <div>
                        <span class="font-medium text-gray-700">Created:</span>
                        <span class="ml-2 text-gray-900" id="ticketDate">2024-01-15 14:30</span>
                    </div>
                    <div>
                        <span class="font-medium text-gray-700">Category:</span>
                        <span class="ml-2 text-gray-900" id="ticketCategory">Billing</span>
                    </div>
                    <div>
                        <span class="font-medium text-gray-700">Assigned to:</span>
                        <span class="ml-2 text-gray-900" id="assignedTo">Admin User</span>
                    </div>
                    <div>
                        <span class="font-medium text-gray-700">Last Updated:</span>
                        <span class="ml-2 text-gray-900" id="lastUpdated">2024-01-15 16:45</span>
                    </div>
                </div>
            </div>

            <!-- Ticket Description -->
            <div class="bg-white rounded-xl shadow-lg p-6 mb-6">
                <h3 class="text-lg font-semibold text-gray-900 mb-4">Description</h3>
                <div class="bg-gray-50 p-4 rounded-lg">
                    <p class="text-gray-700" id="ticketDescription">
                        I'm having trouble with my payment. The transaction failed but my card was charged. 
                        I've been trying to contact support for the past 2 hours but haven't received any response. 
                        This is urgent as I need this order for tomorrow. Please help me resolve this issue as soon as possible.
                    </p>
                </div>
            </div>

            <!-- Messages Thread -->
            <div class="bg-white rounded-xl shadow-lg p-6 mb-6">
                <h3 class="text-lg font-semibold text-gray-900 mb-4">Messages</h3>
                <div class="space-y-4" id="messagesThread">
                    <!-- Messages will be loaded here -->
                </div>
            </div>

            <!-- Reply Form -->
            <div class="bg-white rounded-xl shadow-lg p-6 mb-6">
                <h3 class="text-lg font-semibold text-gray-900 mb-4">Add Response</h3>
                <form id="replyForm" method="POST" action="#">
                    <div class="mb-4">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Response</label>
                        <textarea id="responseMessage" rows="4" 
                                  class="w-full border border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-blue-500 focus:border-blue-500" 
                                  placeholder="Type your response..."></textarea>
                    </div>
                    <div class="mb-4">
                        <label class="flex items-center">
                            <input type="checkbox" id="internalNote" class="mr-2 rounded border-gray-300 text-blue-600 focus:ring-blue-500">
                            <span class="text-sm text-gray-700">Internal note (not visible to customer)</span>
                        </label>
                    </div>
                    <div class="flex justify-end space-x-3">
                        <button type="button" onclick="closeTicket()" 
                                class="px-6 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-all">
                            Close Ticket
                        </button>
                        <button type="submit" 
                                class="px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-all">
                            Send Response
                        </button>
                    </div>
                </form>
            </div>

            <!-- Quick Actions -->
            <div class="bg-white rounded-xl shadow-lg p-6">
                <h3 class="text-lg font-semibold text-gray-900 mb-4">Quick Actions</h3>
                <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                    <button onclick="assignTicket()" 
                            class="flex items-center justify-center px-4 py-3 border border-gray-300 rounded-lg hover:bg-gray-50 transition-all">
                        <i class="fas fa-user-plus mr-2 text-blue-600"></i>
                        <span>Assign Ticket</span>
                    </button>
                    <button onclick="escalateTicket()" 
                            class="flex items-center justify-center px-4 py-3 border border-gray-300 rounded-lg hover:bg-gray-50 transition-all">
                        <i class="fas fa-arrow-up mr-2 text-orange-600"></i>
                        <span>Escalate</span>
                    </button>
                    <button onclick="markAsResolved()" 
                            class="flex items-center justify-center px-4 py-3 border border-gray-300 rounded-lg hover:bg-gray-50 transition-all">
                        <i class="fas fa-check mr-2 text-green-600"></i>
                        <span>Mark Resolved</span>
                    </button>
                    <button onclick="deleteTicket()" 
                            class="flex items-center justify-center px-4 py-3 border border-gray-300 rounded-lg hover:bg-gray-50 transition-all">
                        <i class="fas fa-trash mr-2 text-red-600"></i>
                        <span>Delete</span>
                    </button>
                </div>
            </div>
        </main>
    </div>

    <script>
        // Initialize the page
        document.addEventListener('DOMContentLoaded', function() {
            loadTicketDetails();
            loadMessages();
        });

        function loadTicketDetails() {
            // This would normally load from API
            // For demo purposes, we'll use sample data
            const ticket = {
                id: 'TKT-001',
                subject: 'Payment Issue - Order #12345',
                status: 'Open',
                priority: 'High',
                customerName: 'John Doe',
                customerEmail: 'john@example.com',
                category: 'Billing',
                assignedTo: 'Admin User',
                createdDate: '2024-01-15 14:30',
                lastUpdated: '2024-01-15 16:45',
                description: 'I\'m having trouble with my payment. The transaction failed but my card was charged. I\'ve been trying to contact support for the past 2 hours but haven\'t received any response. This is urgent as I need this order for tomorrow. Please help me resolve this issue as soon as possible.'
            };

            // Update the UI with ticket details
            document.getElementById('ticketSubject').textContent = ticket.subject;
            document.getElementById('ticketStatus').textContent = ticket.status;
            document.getElementById('ticketPriority').textContent = ticket.priority;
            document.getElementById('customerName').textContent = ticket.customerName;
            document.getElementById('customerEmail').textContent = ticket.customerEmail;
            document.getElementById('ticketCategory').textContent = ticket.category;
            document.getElementById('assignedTo').textContent = ticket.assignedTo;
            document.getElementById('ticketDate').textContent = ticket.createdDate;
            document.getElementById('lastUpdated').textContent = ticket.lastUpdated;
            document.getElementById('ticketDescription').textContent = ticket.description;
        }

        function loadMessages() {
            // Sample messages data
            const messages = [
                {
                    id: 1,
                    sender: 'John Doe',
                    role: 'Customer',
                    message: 'I\'m having trouble with my payment. The transaction failed but my card was charged.',
                    date: '2024-01-15 14:30',
                    isInternal: false
                },
                {
                    id: 2,
                    sender: 'Admin User',
                    role: 'Admin',
                    message: 'Thank you for contacting us. I can see the issue with your payment. Let me investigate this for you.',
                    date: '2024-01-15 15:00',
                    isInternal: false
                },
                {
                    id: 3,
                    sender: 'Admin User',
                    role: 'Admin',
                    message: 'Internal note: Customer seems frustrated, need to prioritize this ticket.',
                    date: '2024-01-15 15:05',
                    isInternal: true
                }
            ];

            displayMessages(messages);
        }

        function displayMessages(messages) {
            const messagesDiv = document.getElementById('messagesThread');
            messagesDiv.innerHTML = messages.map(msg => `
                <div class="border-l-4 ${msg.isInternal ? 'border-red-500 bg-red-50' : 'border-blue-500'} pl-4 py-3">
                    <div class="flex justify-between items-start mb-2">
                        <div class="flex items-center">
                            <span class="font-medium text-sm ${msg.isInternal ? 'text-red-700' : 'text-gray-900'}">${msg.sender} (${msg.role})</span>
                            ${msg.isInternal ? '<span class="ml-2 px-2 py-1 text-xs bg-red-100 text-red-800 rounded-full">Internal</span>' : ''}
                        </div>
                        <span class="text-xs text-gray-500">${msg.date}</span>
                    </div>
                    <p class="text-gray-700 text-sm">${msg.message}</p>
                </div>
            `).join('');
        }

        // Form submission
        document.getElementById('replyForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const message = document.getElementById('responseMessage').value;
            const isInternal = document.getElementById('internalNote').checked;

            if (!message.trim()) {
                alert('Please enter a response message');
                return;
            }

            // Here you would normally send to API
            alert('Response sent successfully!');
            document.getElementById('responseMessage').value = '';
            document.getElementById('internalNote').checked = false;
        });

        // Action functions
        function closeTicket() {
            if (confirm('Are you sure you want to close this ticket?')) {
                alert('Ticket closed successfully');
            }
        }

        function assignTicket() {
            alert('Ticket assignment dialog would open here');
        }

        function escalateTicket() {
            if (confirm('Are you sure you want to escalate this ticket?')) {
                alert('Ticket escalated successfully');
            }
        }

        function markAsResolved() {
            if (confirm('Are you sure you want to mark this ticket as resolved?')) {
                alert('Ticket marked as resolved');
            }
        }

        function deleteTicket() {
            if (confirm('Are you sure you want to delete this ticket? This action cannot be undone.')) {
                alert('Ticket deleted successfully');
            }
        }
    </script>

<script>
// Utility Functions for Enhanced Functionality
function showNotification(message, type = 'info') {
    // Create notification element
    const notification = document.createElement('div');
    notification.className = `fixed top-4 right-4 z-50 p-4 rounded-lg shadow-lg transition-all duration-300 ${
        type === 'success' ? 'bg-green-500 text-white' :
        type === 'error' ? 'bg-red-500 text-white' :
        type === 'warning' ? 'bg-yellow-500 text-black' :
        'bg-blue-500 text-white'
    }`;
    notification.textContent = message;
    
    document.body.appendChild(notification);
    
    // Remove after 3 seconds
    setTimeout(() => {
        notification.style.opacity = '0';
        setTimeout(() => notification.remove(), 300);
    }, 3000);
}

// Generic search handlers
function handleProductSearch(query) {
    console.log('Searching products:', query);
    if (query.length > 2) {
        // Implement product search logic
        showNotification('Searching for: ' + query, 'info');
    }
}

function handleSellerSearch(query) {
    console.log('Searching sellers:', query);
    if (query.length > 2) {
        showNotification('Searching sellers: ' + query, 'info');
    }
}

function handleAgentSearch(query) {
    console.log('Searching agents:', query);
    if (query.length > 2) {
        showNotification('Searching agents: ' + query, 'info');
    }
}

function handleOrderSearch(query) {
    console.log('Searching orders:', query);
    if (query.length > 2) {
        showNotification('Searching orders: ' + query, 'info');
    }
}

function handleUserSearch(query) {
    console.log('Searching users:', query);
    if (query.length > 2) {
        showNotification('Searching users: ' + query, 'info');
    }
}

// Generic form handlers
function handleSave() {
    showNotification('Save functionality will be implemented soon', 'info');
}

function handleEdit() {
    showNotification('Edit functionality will be implemented soon', 'info');
}

function handleDelete() {
    if (confirm('Are you sure you want to delete this item?')) {
        showNotification('Delete functionality will be implemented soon', 'info');
    }
}

function handleCancel() {
    if (confirm('Are you sure you want to cancel? Unsaved changes will be lost.')) {
        history.back();
    }
}
</script>
</body>
</html> 