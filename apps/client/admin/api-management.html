<!DOCTYPE html>
<html lang="en" class="admin-page">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>API Management & Documentation | Admin Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-dark.min.css" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script src="admin-auth-check.js"></script>
    <script src="admin-utils.js"></script>
    <style>
        :root {
            --primary-color: #080b3b;
            --secondary-color: #1e40af;
            --accent-color: #3b82f6;
        }
        
        .glass-morphism {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        .gradient-bg {
            background: linear-gradient(135deg, var(--primary-color) 0%, var(--secondary-color) 100%);
        }
        .sidebar {
            background: rgba(0, 0, 0, 0.2);
            backdrop-filter: blur(10px);
            border-right: 1px solid rgba(255, 255, 255, 0.1);
        }
        .nav-item {
            transition: all 0.3s ease;
        }
        .nav-item:hover {
            background: rgba(255, 255, 255, 0.1);
            transform: translateX(5px);
        }
        .nav-item.active {
            background: rgba(255, 255, 255, 0.2);
            border-left: 3px solid #3b82f6;
        }
        .form-input {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: white;
            transition: all 0.3s ease;
        }
        .form-input::placeholder {
            color: rgba(255, 255, 255, 0.5);
        }
        .form-input:focus {
            outline: none;
            border-color: var(--accent-color);
            box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.3);
            background: rgba(255, 255, 255, 0.15);
        }
        .tab-btn {
            cursor: pointer;
            transition: all 0.3s ease;
            padding: 1rem 1.5rem;
            border-radius: 0.5rem;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        .tab-btn:hover {
            background: rgba(255, 255, 255, 0.1);
        }
        .tab-btn.active {
            background: rgba(59, 130, 246, 0.2);
            border-color: var(--accent-color);
        }
        .tab-content {
            display: none;
        }
        .tab-content.active {
            display: block;
        }
        .api-key-card {
            transition: all 0.3s ease;
            cursor: pointer;
        }
        .api-key-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }
        .status-badge {
            @apply px-3 py-1 rounded-full text-xs font-medium;
        }
        .status-active { @apply bg-green-500/20 text-green-400; }
        .status-inactive { @apply bg-gray-500/20 text-gray-400; }
        .status-expired { @apply bg-red-500/20 text-red-400; }
        .status-revoked { @apply bg-yellow-500/20 text-yellow-400; }
        .endpoint-card {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 1.5rem;
            margin-bottom: 1rem;
            transition: all 0.3s ease;
        }
        .endpoint-card:hover {
            background: rgba(255, 255, 255, 0.08);
            transform: translateY(-1px);
        }
        .http-method {
            font-family: 'Courier New', monospace;
            font-weight: bold;
            font-size: 0.75rem;
            padding: 0.25rem 0.75rem;
            border-radius: 0.25rem;
            display: inline-block;
            min-width: 60px;
            text-align: center;
        }
        .method-get { background: rgba(34, 197, 94, 0.2); color: #22c55e; }
        .method-post { background: rgba(59, 130, 246, 0.2); color: #3b82f6; }
        .method-put { background: rgba(245, 158, 11, 0.2); color: #f59e0b; }
        .method-delete { background: rgba(239, 68, 68, 0.2); color: #ef4444; }
        .method-patch { background: rgba(168, 85, 247, 0.2); color: #a855f7; }
        .code-block {
            background: rgba(0, 0, 0, 0.5);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            padding: 1rem;
            font-family: 'Courier New', monospace;
            font-size: 0.875rem;
            color: #f8f9fa;
            overflow-x: auto;
        }
        .copy-btn {
            position: absolute;
            top: 0.5rem;
            right: 0.5rem;
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        .code-container:hover .copy-btn {
            opacity: 1;
        }
        .rate-limit-bar {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            overflow: hidden;
            height: 8px;
        }
        .rate-limit-fill {
            height: 100%;
            transition: width 0.3s ease;
            border-radius: 10px;
        }
        .usage-chart {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 1.5rem;
            min-height: 300px;
        }
        .metric-card {
            text-align: center;
            padding: 1.5rem;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            transition: all 0.3s ease;
        }
        .metric-card:hover {
            background: rgba(255, 255, 255, 0.08);
            transform: translateY(-2px);
        }
        .metric-value {
            font-size: 2rem;
            font-weight: bold;
            margin-bottom: 0.5rem;
        }
        .metric-label {
            font-size: 0.875rem;
            color: rgba(255, 255, 255, 0.7);
        }
        .metric-change {
            font-size: 0.75rem;
            margin-top: 0.25rem;
        }
        .change-positive { color: #22c55e; }
        .change-negative { color: #ef4444; }
        .permission-tag {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            background: rgba(59, 130, 246, 0.2);
            color: #60a5fa;
            border-radius: 1rem;
            font-size: 0.75rem;
            margin: 0.125rem;
        }
        .scope-selector {
            padding: 0.75rem;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            margin-bottom: 0.5rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        .scope-selector:hover {
            background: rgba(255, 255, 255, 0.1);
        }
        .scope-selector.selected {
            background: rgba(59, 130, 246, 0.2);
            border-color: #3b82f6;
        }
        .webhook-card {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 1.5rem;
            margin-bottom: 1rem;
        }
        .webhook-status {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            display: inline-block;
            margin-right: 8px;
        }
        .webhook-active { background-color: #22c55e; animation: pulse 2s infinite; }
        .webhook-inactive { background-color: #ef4444; }
        .webhook-pending { background-color: #f59e0b; animation: pulse 2s infinite; }
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        .alert-banner {
            padding: 1rem 1.5rem;
            border-radius: 8px;
            margin-bottom: 1rem;
            border-left: 4px solid;
        }
        .alert-info {
            background: rgba(59, 130, 246, 0.1);
            border-left-color: #3b82f6;
            color: #93c5fd;
        }
        .alert-warning {
            background: rgba(245, 158, 11, 0.1);
            border-left-color: #f59e0b;
            color: #fbbf24;
        }
        .alert-success {
            background: rgba(34, 197, 94, 0.1);
            border-left-color: #22c55e;
            color: #86efac;
        }
        .alert-error {
            background: rgba(239, 68, 68, 0.1);
            border-left-color: #ef4444;
            color: #fca5a5;
        }
        .live-indicator {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: #22c55e;
            display: inline-block;
            margin-right: 6px;
            animation: pulse 2s infinite;
        }
        .real-time-badge {
            background: linear-gradient(45deg, #22c55e, #16a34a);
            color: white;
            font-size: 0.75rem;
            padding: 0.25rem 0.5rem;
            border-radius: 1rem;
            font-weight: 600;
        }
    </style>
</head>

<body class="gradient-bg min-h-screen">
    <div class="flex h-screen overflow-hidden">
        <!-- Sidebar -->
        <div class="sidebar w-64 lg:w-80 flex-shrink-0 hidden md:flex flex-col">
            <div class="p-6 border-b border-white/10">
                <h2 class="text-xl font-bold text-white">Admin Panel</h2>
            </div>
            
            <nav class="flex-1 p-4 space-y-2 overflow-y-auto">
                <a href="dashboard.html" class="nav-item flex items-center space-x-3 p-3 rounded-lg text-white">
                    <i class="fas fa-tachometer-alt"></i>
                    <span>Dashboard</span>
                </a>
                <!-- Other nav items abbreviated for brevity -->
                <a href="api-management.html" class="nav-item active flex items-center space-x-3 p-3 rounded-lg text-white">
                    <i class="fas fa-code"></i>
                    <span>API Management</span>
                </a>
            </nav>
        </div>

        <!-- Main Content -->
        <div class="flex-1 p-4 sm:p-6 lg:p-8 overflow-auto">
            
            <!-- Header -->
            <div class="flex flex-col sm:flex-row sm:justify-between sm:items-center mb-6 space-y-4 sm:space-y-0">
                <div>
                    <h1 class="text-2xl sm:text-3xl font-bold text-white mb-2 flex items-center">
                        API Management & Documentation
                        <span class="live-indicator ml-3"></span>
                        <span class="real-time-badge ml-2">Live Monitoring</span>
                    </h1>
                    <p class="text-white/70">Manage API keys, monitor usage, and access comprehensive documentation</p>
                </div>
                <div class="flex flex-col sm:flex-row space-y-2 sm:space-y-0 sm:space-x-2">
                    <button onclick="generateAPIKey()" class="bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-lg transition text-sm">
                        <i class="fas fa-plus mr-2"></i>Generate Key
                    </button>
                    <button onclick="testAPI()" class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg transition text-sm">
                        <i class="fas fa-play mr-2"></i>Test API
                    </button>
                    <button onclick="downloadSDK()" class="bg-purple-500 hover:bg-purple-600 text-white px-4 py-2 rounded-lg transition text-sm">
                        <i class="fas fa-download mr-2"></i>Download SDK
                    </button>
                </div>
            </div>

            <!-- API Usage Overview -->
            <div class="grid grid-cols-1 lg:grid-cols-5 gap-4 sm:gap-6 mb-6">
                <div class="metric-card">
                    <div class="metric-value text-blue-400" id="total-requests">847K</div>
                    <div class="metric-label">Total Requests</div>
                    <div class="metric-change change-positive">↑ 23% vs last month</div>
                </div>
                
                <div class="metric-card">
                    <div class="metric-value text-green-400" id="active-keys">28</div>
                    <div class="metric-label">Active API Keys</div>
                    <div class="metric-change change-positive">↑ 3 new this month</div>
                </div>
                
                <div class="metric-card">
                    <div class="metric-value text-yellow-400" id="rate-limit-hits">156</div>
                    <div class="metric-label">Rate Limit Hits</div>
                    <div class="metric-change change-negative">↓ 12% improvement</div>
                </div>
                
                <div class="metric-card">
                    <div class="metric-value text-purple-400" id="avg-response-time">142ms</div>
                    <div class="metric-label">Avg Response Time</div>
                    <div class="metric-change change-positive">↑ 8ms vs last week</div>
                </div>
                
                <div class="metric-card">
                    <div class="metric-value text-red-400" id="error-rate">0.3%</div>
                    <div class="metric-label">Error Rate</div>
                    <div class="metric-change change-negative">↓ 0.1% improvement</div>
                </div>
            </div>

            <!-- System Alerts -->
            <div id="api-alerts" class="mb-6">
                <div class="alert-warning">
                    <div class="flex items-center space-x-3">
                        <i class="fas fa-exclamation-triangle"></i>
                        <div class="flex-1">
                            <div class="font-medium">Rate Limiting Exceeded</div>
                            <div class="text-sm opacity-90">API key "ecom_prod_xyz789" exceeded rate limit 12 times in the last hour</div>
                        </div>
                        <button onclick="this.closest('.alert-warning').remove()" class="opacity-70 hover:opacity-100">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                </div>
            </div>

            <!-- Tab Navigation -->
            <div class="flex flex-wrap gap-2 mb-6">
                <div class="tab-btn active" data-tab="keys" onclick="switchTab('keys')">
                    <div class="flex items-center space-x-2">
                        <i class="fas fa-key"></i>
                        <span class="text-white font-medium">API Keys</span>
                        <span class="text-white/50 text-sm">(28)</span>
                    </div>
                </div>
                <div class="tab-btn" data-tab="documentation" onclick="switchTab('documentation')">
                    <div class="flex items-center space-x-2">
                        <i class="fas fa-book"></i>
                        <span class="text-white font-medium">Documentation</span>
                    </div>
                </div>
                <div class="tab-btn" data-tab="analytics" onclick="switchTab('analytics')">
                    <div class="flex items-center space-x-2">
                        <i class="fas fa-chart-line"></i>
                        <span class="text-white font-medium">Analytics</span>
                    </div>
                </div>
                <div class="tab-btn" data-tab="webhooks" onclick="switchTab('webhooks')">
                    <div class="flex items-center space-x-2">
                        <i class="fas fa-webhook"></i>
                        <span class="text-white font-medium">Webhooks</span>
                        <span class="text-white/50 text-sm">(12)</span>
                    </div>
                </div>
                <div class="tab-btn" data-tab="rate-limits" onclick="switchTab('rate-limits')">
                    <div class="flex items-center space-x-2">
                        <i class="fas fa-tachometer-alt"></i>
                        <span class="text-white font-medium">Rate Limits</span>
                    </div>
                </div>
                <div class="tab-btn" data-tab="testing" onclick="switchTab('testing')">
                    <div class="flex items-center space-x-2">
                        <i class="fas fa-flask"></i>
                        <span class="text-white font-medium">API Testing</span>
                    </div>
                </div>
            </div>

            <!-- Tab Contents -->

            <!-- API Keys Tab -->
            <div id="keys-tab" class="tab-content active">
                <div class="grid grid-cols-1 xl:grid-cols-3 gap-6">
                    
                    <!-- API Keys List -->
                    <div class="xl:col-span-2">
                        <div class="glass-morphism rounded-xl overflow-hidden">
                            <div class="p-6 border-b border-white/10">
                                <div class="flex justify-between items-center">
                                    <h3 class="text-xl font-bold text-white">Active API Keys</h3>
                                    <div class="flex space-x-2">
                                        <select id="key-filter" class="form-input px-3 py-2 rounded-lg text-sm" onchange="filterAPIKeys()">
                                            <option value="">All Keys</option>
                                            <option value="active">Active</option>
                                            <option value="expired">Expired</option>
                                            <option value="revoked">Revoked</option>
                                        </select>
                                        <button onclick="bulkManageKeys()" class="bg-yellow-500 hover:bg-yellow-600 text-white px-3 py-2 rounded-lg text-sm">
                                            <i class="fas fa-tasks mr-2"></i>Bulk Manage
                                        </button>
                                    </div>
                                </div>
                            </div>

                            <div id="api-keys-container" class="p-6">
                                <!-- API Keys will be populated here -->
                            </div>
                        </div>
                    </div>

                    <!-- Generate New Key -->
                    <div>
                        <div class="glass-morphism rounded-xl p-6 mb-6">
                            <h3 class="text-xl font-bold text-white mb-4">Generate New API Key</h3>
                            
                            <div class="space-y-4">
                                <div>
                                    <label class="block text-white/70 text-sm mb-2">Key Name</label>
                                    <input type="text" id="new-key-name" 
                                           class="w-full p-3 rounded-lg form-input" 
                                           placeholder="e.g., Mobile App Production">
                                </div>
                                
                                <div>
                                    <label class="block text-white/70 text-sm mb-2">Description</label>
                                    <textarea id="new-key-description" rows="3" 
                                              class="w-full p-3 rounded-lg form-input resize-none"
                                              placeholder="Brief description of key usage"></textarea>
                                </div>
                                
                                <div>
                                    <label class="block text-white/70 text-sm mb-2">Environment</label>
                                    <select id="new-key-environment" class="w-full p-3 rounded-lg form-input">
                                        <option value="production">Production</option>
                                        <option value="staging">Staging</option>
                                        <option value="development">Development</option>
                                        <option value="testing">Testing</option>
                                    </select>
                                </div>
                                
                                <div>
                                    <label class="block text-white/70 text-sm mb-2">Permissions & Scopes</label>
                                    <div id="permission-scopes" class="space-y-2">
                                        <!-- Scopes will be populated here -->
                                    </div>
                                </div>
                                
                                <div class="grid grid-cols-2 gap-4">
                                    <div>
                                        <label class="block text-white/70 text-sm mb-2">Rate Limit (req/min)</label>
                                        <input type="number" id="new-key-rate-limit" value="1000" min="10" max="10000" 
                                               class="w-full p-3 rounded-lg form-input">
                                    </div>
                                    
                                    <div>
                                        <label class="block text-white/70 text-sm mb-2">Expires In</label>
                                        <select id="new-key-expires" class="w-full p-3 rounded-lg form-input">
                                            <option value="30">30 Days</option>
                                            <option value="90">90 Days</option>
                                            <option value="180">180 Days</option>
                                            <option value="365" selected>1 Year</option>
                                            <option value="0">Never</option>
                                        </select>
                                    </div>
                                </div>
                                
                                <button onclick="createAPIKey()" class="w-full bg-green-500 hover:bg-green-600 text-white px-4 py-3 rounded-lg">
                                    <i class="fas fa-key mr-2"></i>Generate API Key
                                </button>
                            </div>
                        </div>

                        <!-- Quick Stats -->
                        <div class="glass-morphism rounded-xl p-6">
                            <h3 class="text-lg font-bold text-white mb-4">Key Statistics</h3>
                            
                            <div class="space-y-4 text-sm">
                                <div class="flex justify-between">
                                    <span class="text-white/70">Total Keys:</span>
                                    <span class="text-white font-semibold">32</span>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-white/70">Active Keys:</span>
                                    <span class="text-green-400 font-semibold">28</span>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-white/70">Expired Keys:</span>
                                    <span class="text-yellow-400 font-semibold">3</span>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-white/70">Revoked Keys:</span>
                                    <span class="text-red-400 font-semibold">1</span>
                                </div>
                                <div class="flex justify-between border-t border-white/10 pt-3">
                                    <span class="text-white/70">Avg Usage:</span>
                                    <span class="text-blue-400 font-semibold">2.4K req/day</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Documentation Tab -->
            <div id="documentation-tab" class="tab-content">
                <div class="grid grid-cols-1 xl:grid-cols-4 gap-6">
                    
                    <!-- Endpoints List -->
                    <div class="xl:col-span-3">
                        <div class="glass-morphism rounded-xl p-6 mb-6">
                            <div class="flex justify-between items-center mb-6">
                                <h3 class="text-xl font-bold text-white">API Endpoints</h3>
                                <div class="flex space-x-2">
                                    <select id="endpoint-category" class="form-input px-3 py-2 rounded-lg text-sm" onchange="filterEndpoints()">
                                        <option value="">All Categories</option>
                                        <option value="authentication">Authentication</option>
                                        <option value="users">Users</option>
                                        <option value="products">Products</option>
                                        <option value="orders">Orders</option>
                                        <option value="payments">Payments</option>
                                        <option value="analytics">Analytics</option>
                                    </select>
                                    <button onclick="exportDocumentation()" class="bg-blue-500 hover:bg-blue-600 text-white px-3 py-2 rounded-lg text-sm">
                                        <i class="fas fa-download mr-2"></i>Export Docs
                                    </button>
                                </div>
                            </div>

                            <div id="endpoints-container">
                                <!-- Endpoints will be populated here -->
                            </div>
                        </div>
                    </div>

                    <!-- Quick Reference -->
                    <div>
                        <div class="glass-morphism rounded-xl p-6 mb-6">
                            <h3 class="text-lg font-bold text-white mb-4">Quick Reference</h3>
                            
                            <div class="space-y-3 text-sm">
                                <div>
                                    <div class="text-white/70 mb-1">Base URL:</div>
                                    <div class="text-blue-400 font-mono text-xs break-all">
                                        https://api.africandeals.com/v1
                                    </div>
                                </div>
                                
                                <div>
                                    <div class="text-white/70 mb-1">Authentication:</div>
                                    <div class="text-white font-mono text-xs">
                                        Authorization: Bearer {api_key}
                                    </div>
                                </div>
                                
                                <div>
                                    <div class="text-white/70 mb-1">Content-Type:</div>
                                    <div class="text-white font-mono text-xs">
                                        application/json
                                    </div>
                                </div>
                                
                                <div>
                                    <div class="text-white/70 mb-1">Rate Limit:</div>
                                    <div class="text-white text-xs">
                                        1000 requests per minute
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Response Codes -->
                        <div class="glass-morphism rounded-xl p-6">
                            <h3 class="text-lg font-bold text-white mb-4">Response Codes</h3>
                            
                            <div class="space-y-2 text-sm">
                                <div class="flex justify-between">
                                    <span class="text-green-400 font-mono">200</span>
                                    <span class="text-white/70">Success</span>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-blue-400 font-mono">201</span>
                                    <span class="text-white/70">Created</span>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-yellow-400 font-mono">400</span>
                                    <span class="text-white/70">Bad Request</span>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-red-400 font-mono">401</span>
                                    <span class="text-white/70">Unauthorized</span>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-red-400 font-mono">403</span>
                                    <span class="text-white/70">Forbidden</span>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-red-400 font-mono">404</span>
                                    <span class="text-white/70">Not Found</span>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-red-400 font-mono">429</span>
                                    <span class="text-white/70">Rate Limited</span>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-red-400 font-mono">500</span>
                                    <span class="text-white/70">Server Error</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Analytics Tab -->
            <div id="analytics-tab" class="tab-content">
                <div class="grid grid-cols-1 xl:grid-cols-2 gap-6">
                    
                    <!-- Usage Charts -->
                    <div class="usage-chart">
                        <h3 class="text-lg font-bold text-white mb-4">API Usage Trends</h3>
                        <div id="usage-chart-container" class="flex items-center justify-center h-48">
                            <div class="text-center text-white/60">
                                <i class="fas fa-chart-line text-4xl mb-3"></i>
                                <p>Usage analytics chart would appear here</p>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Top Endpoints -->
                    <div class="glass-morphism rounded-xl p-6">
                        <h3 class="text-lg font-bold text-white mb-4">Top Endpoints</h3>
                        
                        <div id="top-endpoints" class="space-y-3">
                            <!-- Will be populated by JavaScript -->
                        </div>
                    </div>
                    
                    <!-- Error Analysis -->
                    <div class="glass-morphism rounded-xl p-6">
                        <h3 class="text-lg font-bold text-white mb-4">Error Analysis</h3>
                        
                        <div id="error-analysis" class="space-y-3">
                            <!-- Will be populated by JavaScript -->
                        </div>
                    </div>
                    
                    <!-- Performance Metrics -->
                    <div class="glass-morphism rounded-xl p-6">
                        <h3 class="text-lg font-bold text-white mb-4">Performance Metrics</h3>
                        
                        <div id="performance-metrics" class="space-y-4">
                            <!-- Will be populated by JavaScript -->
                        </div>
                    </div>
                </div>
            </div>

            <!-- Webhooks Tab -->
            <div id="webhooks-tab" class="tab-content">
                <!-- Webhooks content -->
            </div>

            <!-- Rate Limits Tab -->
            <div id="rate-limits-tab" class="tab-content">
                <!-- Rate limits content -->
            </div>

            <!-- API Testing Tab -->
            <div id="testing-tab" class="tab-content">
                <!-- API testing content -->
            </div>
        </div>
    </div>

<script>
    // Global variables
    let currentTab = 'keys';
    let apiKeys = [];
    let apiEndpoints = [];
    let webhooks = [];
    let apiAnalytics = {};

    // Initialize
    document.addEventListener('DOMContentLoaded', function() {
        console.log('🔌 API Management & Documentation initializing...');
        
        // Check authentication first
        if (!checkAuthentication()) return;
        
        // Load all API data
        loadAllAPIData();
        setupEventListeners();
        
        console.log('✅ API Management & Documentation initialized');
    });

    // Check authentication
    function checkAuthentication() {
        const token = localStorage.getItem('adminToken') || localStorage.getItem('token');
        const userRole = localStorage.getItem('userRole');
        
        if (!token || userRole !== 'admin') {
            console.log('❌ Authentication failed');
            window.location.href = '/auth/auth-admin.html';
            return false;
        }
        
        return true;
    }

    // Setup event listeners
    function setupEventListeners() {
        // Auto-refresh API stats every 30 seconds
        setInterval(updateAPIStats, 30000);
    }

    // Load all API data
    async function loadAllAPIData() {
        try {
            await Promise.all([
                loadAPIKeys(),
                loadAPIEndpoints(),
                loadWebhooks(),
                loadAPIAnalytics(),
                loadPermissionScopes()
            ]);
        } catch (error) {
            console.error('❌ Error loading API data:', error);
            showToast('Error loading API data', 'error');
        }
    }

    // Load API keys
    async function loadAPIKeys() {
        try {
            console.log('🔑 Loading API keys...');
            
            apiKeys = [
                {
                    id: 1,
                    name: 'Mobile App Production',
                    key: 'ecom_prod_xyz789...',
                    environment: 'production',
                    status: 'active',
                    created: new Date(Date.now() - 30 * 24 * 60 * 60 * 1000),
                    expires: new Date(Date.now() + 335 * 24 * 60 * 60 * 1000),
                    last_used: new Date(Date.now() - 2 * 60 * 60 * 1000),
                    usage_today: 8432,
                    rate_limit: 5000,
                    permissions: ['read:products', 'write:orders', 'read:users']
                },
                {
                    id: 2,
                    name: 'Web Dashboard API',
                    key: 'ecom_dash_abc123...',
                    environment: 'production',
                    status: 'active',
                    created: new Date(Date.now() - 60 * 24 * 60 * 60 * 1000),
                    expires: new Date(Date.now() + 305 * 24 * 60 * 60 * 1000),
                    last_used: new Date(Date.now() - 5 * 60 * 1000),
                    usage_today: 15678,
                    rate_limit: 10000,
                    permissions: ['read:products', 'write:products', 'read:orders', 'write:orders', 'read:analytics']
                },
                {
                    id: 3,
                    name: 'Third-party Integration',
                    key: 'ecom_3rd_def456...',
                    environment: 'production',
                    status: 'active',
                    created: new Date(Date.now() - 90 * 24 * 60 * 60 * 1000),
                    expires: new Date(Date.now() + 275 * 24 * 60 * 60 * 1000),
                    last_used: new Date(Date.now() - 30 * 60 * 1000),
                    usage_today: 3421,
                    rate_limit: 2000,
                    permissions: ['read:products', 'read:orders']
                },
                {
                    id: 4,
                    name: 'Development Testing',
                    key: 'ecom_dev_ghi789...',
                    environment: 'development',
                    status: 'active',
                    created: new Date(Date.now() - 15 * 24 * 60 * 60 * 1000),
                    expires: new Date(Date.now() + 350 * 24 * 60 * 60 * 1000),
                    last_used: new Date(Date.now() - 4 * 60 * 60 * 1000),
                    usage_today: 1234,
                    rate_limit: 1000,
                    permissions: ['read:products', 'write:products']
                },
                {
                    id: 5,
                    name: 'Legacy Mobile App',
                    key: 'ecom_legacy_jkl012...',
                    environment: 'production',
                    status: 'expired',
                    created: new Date(Date.now() - 400 * 24 * 60 * 60 * 1000),
                    expires: new Date(Date.now() - 5 * 24 * 60 * 60 * 1000),
                    last_used: new Date(Date.now() - 10 * 24 * 60 * 60 * 1000),
                    usage_today: 0,
                    rate_limit: 5000,
                    permissions: ['read:products', 'read:orders']
                }
            ];

            renderAPIKeys();
            
        } catch (error) {
            console.error('❌ Error loading API keys:', error);
        }
    }

    // Load API endpoints documentation
    async function loadAPIEndpoints() {
        try {
            console.log('📚 Loading API endpoints...');
            
            apiEndpoints = [
                {
                    method: 'GET',
                    path: '/auth/login',
                    category: 'authentication',
                    name: 'User Login',
                    description: 'Authenticate user and return access token',
                    parameters: [
                        { name: 'email', type: 'string', required: true, description: 'User email address' },
                        { name: 'password', type: 'string', required: true, description: 'User password' }
                    ],
                    response_example: {
                        "success": true,
                        "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
                        "user": {
                            "id": 1,
                            "email": "user@example.com",
                            "role": "buyer"
                        }
                    }
                },
                {
                    method: 'GET',
                    path: '/products',
                    category: 'products',
                    name: 'List Products',
                    description: 'Get paginated list of products with filters',
                    parameters: [
                        { name: 'page', type: 'integer', required: false, description: 'Page number (default: 1)' },
                        { name: 'limit', type: 'integer', required: false, description: 'Items per page (default: 20)' },
                        { name: 'category', type: 'string', required: false, description: 'Filter by category' },
                        { name: 'search', type: 'string', required: false, description: 'Search in product names' }
                    ],
                    response_example: {
                        "success": true,
                        "data": [
                            {
                                "id": 1,
                                "name": "Premium Coffee Beans",
                                "price": 25.99,
                                "category": "beverages"
                            }
                        ],
                        "pagination": {
                            "page": 1,
                            "limit": 20,
                            "total": 150
                        }
                    }
                },
                {
                    method: 'POST',
                    path: '/products',
                    category: 'products',
                    name: 'Create Product',
                    description: 'Create a new product (seller or admin only)',
                    parameters: [
                        { name: 'name', type: 'string', required: true, description: 'Product name' },
                        { name: 'description', type: 'string', required: true, description: 'Product description' },
                        { name: 'price', type: 'number', required: true, description: 'Product price' },
                        { name: 'category_id', type: 'integer', required: true, description: 'Category ID' }
                    ],
                    response_example: {
                        "success": true,
                        "data": {
                            "id": 151,
                            "name": "Premium Coffee Beans",
                            "price": 25.99,
                            "status": "pending"
                        }
                    }
                },
                {
                    method: 'GET',
                    path: '/orders/{id}',
                    category: 'orders',
                    name: 'Get Order Details',
                    description: 'Retrieve detailed information about a specific order',
                    parameters: [
                        { name: 'id', type: 'integer', required: true, description: 'Order ID' }
                    ],
                    response_example: {
                        "success": true,
                        "data": {
                            "id": 1001,
                            "status": "delivered",
                            "total": 75.98,
                            "items": [
                                {
                                    "product_id": 1,
                                    "quantity": 2,
                                    "price": 25.99
                                }
                            ]
                        }
                    }
                },
                {
                    method: 'PUT',
                    path: '/orders/{id}/status',
                    category: 'orders',
                    name: 'Update Order Status',
                    description: 'Update the status of an order (seller or admin only)',
                    parameters: [
                        { name: 'id', type: 'integer', required: true, description: 'Order ID' },
                        { name: 'status', type: 'string', required: true, description: 'New order status' }
                    ],
                    response_example: {
                        "success": true,
                        "data": {
                            "id": 1001,
                            "status": "shipped",
                            "updated_at": "2025-01-17T10:30:00Z"
                        }
                    }
                },
                {
                    method: 'POST',
                    path: '/payments/process',
                    category: 'payments',
                    name: 'Process Payment',
                    description: 'Process payment for an order',
                    parameters: [
                        { name: 'order_id', type: 'integer', required: true, description: 'Order ID' },
                        { name: 'payment_method', type: 'string', required: true, description: 'Payment method (card, mobile, bank)' },
                        { name: 'payment_details', type: 'object', required: true, description: 'Payment method specific details' }
                    ],
                    response_example: {
                        "success": true,
                        "data": {
                            "payment_id": "pay_123456",
                            "status": "completed",
                            "amount": 75.98
                        }
                    }
                }
            ];

            renderAPIEndpoints();
            
        } catch (error) {
            console.error('❌ Error loading API endpoints:', error);
        }
    }

    // Load webhooks
    async function loadWebhooks() {
        try {
            console.log('🪝 Loading webhooks...');
            
            webhooks = [
                {
                    id: 1,
                    name: 'Order Status Updates',
                    url: 'https://partner.example.com/webhooks/orders',
                    events: ['order.created', 'order.updated', 'order.completed'],
                    status: 'active',
                    created: new Date(Date.now() - 45 * 24 * 60 * 60 * 1000),
                    last_triggered: new Date(Date.now() - 30 * 60 * 1000),
                    success_rate: 98.5,
                    total_calls: 15672
                },
                {
                    id: 2,
                    name: 'Payment Notifications',
                    url: 'https://accounting.example.com/webhook',
                    events: ['payment.completed', 'payment.failed'],
                    status: 'active',
                    created: new Date(Date.now() - 90 * 24 * 60 * 60 * 1000),
                    last_triggered: new Date(Date.now() - 5 * 60 * 1000),
                    success_rate: 99.2,
                    total_calls: 8943
                },
                {
                    id: 3,
                    name: 'Inventory Alerts',
                    url: 'https://inventory.example.com/alerts',
                    events: ['product.out_of_stock', 'product.low_stock'],
                    status: 'pending',
                    created: new Date(Date.now() - 2 * 24 * 60 * 60 * 1000),
                    last_triggered: null,
                    success_rate: 0,
                    total_calls: 0
                }
            ];
            
        } catch (error) {
            console.error('❌ Error loading webhooks:', error);
        }
    }

    // Load API analytics
    async function loadAPIAnalytics() {
        try {
            console.log('📊 Loading API analytics...');
            
            apiAnalytics = {
                top_endpoints: [
                    { endpoint: 'GET /products', requests: 234567, avg_response: 145 },
                    { endpoint: 'POST /orders', requests: 89432, avg_response: 312 },
                    { endpoint: 'GET /orders', requests: 67891, avg_response: 198 },
                    { endpoint: 'PUT /orders/{id}/status', requests: 45678, avg_response: 234 },
                    { endpoint: 'GET /users/profile', requests: 34567, avg_response: 87 }
                ],
                error_analysis: [
                    { error: '401 Unauthorized', count: 1234, percentage: 45.2 },
                    { error: '404 Not Found', count: 892, percentage: 32.7 },
                    { error: '429 Rate Limit', count: 456, percentage: 16.7 },
                    { error: '500 Server Error', count: 148, percentage: 5.4 }
                ],
                performance_metrics: {
                    avg_response_time: '142ms',
                    p95_response_time: '567ms',
                    p99_response_time: '1.2s',
                    uptime: '99.8%',
                    error_rate: '0.3%'
                }
            };

            renderAnalytics();
            
        } catch (error) {
            console.error('❌ Error loading API analytics:', error);
        }
    }

    // Load permission scopes
    async function loadPermissionScopes() {
        try {
            const scopes = [
                { id: 'read:products', name: 'Read Products', description: 'View product information' },
                { id: 'write:products', name: 'Write Products', description: 'Create and modify products' },
                { id: 'read:orders', name: 'Read Orders', description: 'View order information' },
                { id: 'write:orders', name: 'Write Orders', description: 'Create and modify orders' },
                { id: 'read:users', name: 'Read Users', description: 'View user information' },
                { id: 'write:users', name: 'Write Users', description: 'Create and modify users' },
                { id: 'read:analytics', name: 'Read Analytics', description: 'Access analytics data' },
                { id: 'admin:all', name: 'Admin Access', description: 'Full administrative access' }
            ];

            renderPermissionScopes(scopes);
            
        } catch (error) {
            console.error('❌ Error loading permission scopes:', error);
        }
    }

    // Render functions
    function renderAPIKeys() {
        const container = document.getElementById('api-keys-container');
        
        const keysHTML = apiKeys.map(key => `
            <div class="api-key-card glass-morphism rounded-lg p-6 mb-4" onclick="viewAPIKey(${key.id})">
                <div class="flex items-start justify-between mb-4">
                    <div class="flex-1">
                        <div class="flex items-center space-x-3 mb-2">
                            <h4 class="text-white font-semibold">${key.name}</h4>
                            <span class="status-badge status-${key.status}">
                                ${key.status.charAt(0).toUpperCase() + key.status.slice(1)}
                            </span>
                            <span class="px-2 py-1 bg-blue-500/20 text-blue-400 text-xs rounded-full">
                                ${key.environment}
                            </span>
                        </div>
                        <div class="text-white/60 text-sm font-mono">
                            ${key.key}
                            <button onclick="event.stopPropagation(); copyToClipboard('${key.key}')" 
                                    class="ml-2 text-blue-400 hover:text-blue-300">
                                <i class="fas fa-copy"></i>
                            </button>
                        </div>
                    </div>
                    <div class="text-right">
                        <div class="text-white font-bold">${key.usage_today.toLocaleString()}</div>
                        <div class="text-white/50 text-xs">requests today</div>
                    </div>
                </div>

                <div class="grid grid-cols-2 md:grid-cols-4 gap-4 text-sm mb-4">
                    <div>
                        <span class="text-white/50">Created:</span>
                        <p class="text-white">${formatDate(key.created)}</p>
                    </div>
                    <div>
                        <span class="text-white/50">Expires:</span>
                        <p class="text-white">${key.status === 'expired' ? 'Expired' : formatDate(key.expires)}</p>
                    </div>
                    <div>
                        <span class="text-white/50">Last Used:</span>
                        <p class="text-white">${formatTimeAgo(key.last_used)}</p>
                    </div>
                    <div>
                        <span class="text-white/50">Rate Limit:</span>
                        <p class="text-white">${key.rate_limit}/min</p>
                    </div>
                </div>

                <div class="mb-4">
                    <div class="text-white/50 text-xs mb-2">Usage Today (${key.usage_today}/${key.rate_limit * 24 * 60})</div>
                    <div class="rate-limit-bar">
                        <div class="rate-limit-fill bg-gradient-to-r from-blue-500 to-green-500" 
                             style="width: ${Math.min(100, (key.usage_today / (key.rate_limit * 24 * 60)) * 100)}%"></div>
                    </div>
                </div>

                <div class="mb-4">
                    <p class="text-white/50 text-xs mb-2">Permissions:</p>
                    <div class="flex flex-wrap gap-1">
                        ${key.permissions.map(perm => `
                            <span class="permission-tag">${perm}</span>
                        `).join('')}
                    </div>
                </div>

                <div class="flex space-x-2">
                    <button onclick="event.stopPropagation(); regenerateKey(${key.id})" 
                            class="bg-yellow-500 hover:bg-yellow-600 text-white px-3 py-2 rounded text-sm">
                        <i class="fas fa-sync mr-1"></i>Regenerate
                    </button>
                    <button onclick="event.stopPropagation(); editKey(${key.id})" 
                            class="bg-blue-500 hover:bg-blue-600 text-white px-3 py-2 rounded text-sm">
                        <i class="fas fa-edit mr-1"></i>Edit
                    </button>
                    ${key.status === 'active' ? `
                        <button onclick="event.stopPropagation(); revokeKey(${key.id})" 
                                class="bg-red-500 hover:bg-red-600 text-white px-3 py-2 rounded text-sm">
                            <i class="fas fa-ban mr-1"></i>Revoke
                        </button>
                    ` : key.status === 'expired' ? `
                        <button onclick="event.stopPropagation(); renewKey(${key.id})" 
                                class="bg-green-500 hover:bg-green-600 text-white px-3 py-2 rounded text-sm">
                            <i class="fas fa-renew mr-1"></i>Renew
                        </button>
                    ` : ''}
                    <button onclick="event.stopPropagation(); deleteKey(${key.id})" 
                            class="bg-red-500 hover:bg-red-600 text-white px-3 py-2 rounded text-sm">
                        <i class="fas fa-trash mr-1"></i>Delete
                    </button>
                </div>
            </div>
        `).join('');
        
        container.innerHTML = keysHTML;
    }

    function renderAPIEndpoints() {
        const container = document.getElementById('endpoints-container');
        
        const endpointsHTML = apiEndpoints.map(endpoint => `
            <div class="endpoint-card">
                <div class="flex items-start space-x-4 mb-4">
                    <span class="http-method method-${endpoint.method.toLowerCase()}">${endpoint.method}</span>
                    <div class="flex-1">
                        <div class="flex items-center space-x-2 mb-2">
                            <h4 class="text-white font-semibold">${endpoint.name}</h4>
                            <span class="px-2 py-1 bg-purple-500/20 text-purple-400 text-xs rounded-full">
                                ${endpoint.category}
                            </span>
                        </div>
                        <div class="text-white/60 text-sm font-mono mb-2">${endpoint.path}</div>
                        <p class="text-white/70 text-sm">${endpoint.description}</p>
                    </div>
                    <button onclick="toggleEndpointDetails(${apiEndpoints.indexOf(endpoint)})" 
                            class="text-blue-400 hover:text-blue-300">
                        <i class="fas fa-chevron-down"></i>
                    </button>
                </div>

                <div id="endpoint-details-${apiEndpoints.indexOf(endpoint)}" class="endpoint-details hidden">
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                        <!-- Parameters -->
                        <div>
                            <h5 class="text-white font-medium mb-3">Parameters</h5>
                            <div class="space-y-2">
                                ${endpoint.parameters.map(param => `
                                    <div class="flex justify-between items-start p-2 bg-white/5 rounded">
                                        <div class="flex-1">
                                            <div class="flex items-center space-x-2">
                                                <span class="text-white font-mono text-sm">${param.name}</span>
                                                <span class="text-blue-400 text-xs">${param.type}</span>
                                                ${param.required ? '<span class="text-red-400 text-xs">required</span>' : '<span class="text-gray-400 text-xs">optional</span>'}
                                            </div>
                                            <p class="text-white/60 text-xs mt-1">${param.description}</p>
                                        </div>
                                    </div>
                                `).join('')}
                            </div>
                        </div>

                        <!-- Response Example -->
                        <div>
                            <h5 class="text-white font-medium mb-3">Response Example</h5>
                            <div class="code-container relative">
                                <button onclick="copyToClipboard('${JSON.stringify(endpoint.response_example, null, 2).replace(/'/g, "\\'")}')" 
                                        class="copy-btn bg-blue-500 hover:bg-blue-600 text-white px-2 py-1 rounded text-xs">
                                    <i class="fas fa-copy"></i>
                                </button>
                                <pre class="code-block"><code class="language-json">${JSON.stringify(endpoint.response_example, null, 2)}</code></pre>
                            </div>
                        </div>
                    </div>

                    <div class="flex space-x-2 mt-4">
                        <button onclick="testEndpoint('${endpoint.method}', '${endpoint.path}')" 
                                class="bg-green-500 hover:bg-green-600 text-white px-3 py-2 rounded text-sm">
                            <i class="fas fa-play mr-1"></i>Test Endpoint
                        </button>
                        <button onclick="generateCode('${endpoint.method}', '${endpoint.path}')" 
                                class="bg-blue-500 hover:bg-blue-600 text-white px-3 py-2 rounded text-sm">
                            <i class="fas fa-code mr-1"></i>Generate Code
                        </button>
                    </div>
                </div>
            </div>
        `).join('');
        
        container.innerHTML = endpointsHTML;
    }

    function renderPermissionScopes(scopes) {
        const container = document.getElementById('permission-scopes');
        
        const scopesHTML = scopes.map(scope => `
            <div class="scope-selector" data-scope="${scope.id}" onclick="toggleScope('${scope.id}')">
                <div class="flex items-center space-x-3">
                    <input type="checkbox" class="scope-checkbox" id="scope-${scope.id}">
                    <div class="flex-1">
                        <div class="text-white font-medium text-sm">${scope.name}</div>
                        <div class="text-white/60 text-xs">${scope.description}</div>
                    </div>
                </div>
            </div>
        `).join('');
        
        container.innerHTML = scopesHTML;
    }

    function renderAnalytics() {
        // Top Endpoints
        const topEndpoints = document.getElementById('top-endpoints');
        topEndpoints.innerHTML = apiAnalytics.top_endpoints.map(endpoint => `
            <div class="flex justify-between items-center p-3 bg-white/5 rounded-lg">
                <div class="flex-1">
                    <div class="text-white font-medium text-sm font-mono">${endpoint.endpoint}</div>
                    <div class="text-white/60 text-xs">${endpoint.requests.toLocaleString()} requests</div>
                </div>
                <div class="text-right">
                    <div class="text-blue-400 font-bold">${endpoint.avg_response}ms</div>
                    <div class="text-white/50 text-xs">avg response</div>
                </div>
            </div>
        `).join('');

        // Error Analysis
        const errorAnalysis = document.getElementById('error-analysis');
        errorAnalysis.innerHTML = apiAnalytics.error_analysis.map(error => `
            <div class="flex justify-between items-center p-3 bg-white/5 rounded-lg">
                <div class="flex-1">
                    <div class="text-white font-medium text-sm">${error.error}</div>
                    <div class="text-white/60 text-xs">${error.count.toLocaleString()} occurrences</div>
                </div>
                <div class="text-right">
                    <div class="text-red-400 font-bold">${error.percentage}%</div>
                    <div class="w-16 h-2 bg-white/10 rounded-full overflow-hidden">
                        <div class="h-full bg-red-500 rounded-full" style="width: ${error.percentage}%"></div>
                    </div>
                </div>
            </div>
        `).join('');

        // Performance Metrics
        const performanceMetrics = document.getElementById('performance-metrics');
        performanceMetrics.innerHTML = `
            <div class="grid grid-cols-2 gap-4 text-sm">
                <div class="text-center p-3 bg-white/5 rounded">
                    <div class="text-green-400 font-bold text-lg">${apiAnalytics.performance_metrics.avg_response_time}</div>
                    <div class="text-white/70">Average Response</div>
                </div>
                <div class="text-center p-3 bg-white/5 rounded">
                    <div class="text-yellow-400 font-bold text-lg">${apiAnalytics.performance_metrics.p95_response_time}</div>
                    <div class="text-white/70">95th Percentile</div>
                </div>
                <div class="text-center p-3 bg-white/5 rounded">
                    <div class="text-orange-400 font-bold text-lg">${apiAnalytics.performance_metrics.p99_response_time}</div>
                    <div class="text-white/70">99th Percentile</div>
                </div>
                <div class="text-center p-3 bg-white/5 rounded">
                    <div class="text-blue-400 font-bold text-lg">${apiAnalytics.performance_metrics.uptime}</div>
                    <div class="text-white/70">Uptime</div>
                </div>
            </div>
        `;
    }

    // Update API stats in real-time
    function updateAPIStats() {
        // Simulate real-time updates
        const totalRequests = document.getElementById('total-requests');
        const currentValue = parseInt(totalRequests.textContent.replace(/[K,]/g, ''));
        const newValue = currentValue + Math.floor(Math.random() * 5) + 1;
        totalRequests.textContent = (newValue / 1000).toFixed(0) + 'K';

        // Update response time
        const responseTime = document.getElementById('avg-response-time');
        const currentTime = parseInt(responseTime.textContent.replace('ms', ''));
        const variation = Math.floor(Math.random() * 20) - 10; // -10 to +10ms variation
        responseTime.textContent = Math.max(100, currentTime + variation) + 'ms';
    }

    // Tab switching
    function switchTab(tab) {
        currentTab = tab;
        
        // Update active tab
        document.querySelectorAll('.tab-btn').forEach(t => t.classList.remove('active'));
        document.querySelector(`[data-tab="${tab}"]`).classList.add('active');
        
        // Show/hide tab content
        document.querySelectorAll('.tab-content').forEach(content => {
            content.classList.remove('active');
        });
        document.getElementById(`${tab}-tab`).classList.add('active');
    }

    // Utility functions
    function formatDate(date) {
        return new Date(date).toLocaleDateString();
    }

    function formatTimeAgo(date) {
        const now = new Date();
        const diffInSeconds = Math.floor((now - new Date(date)) / 1000);
        
        if (diffInSeconds < 60) return 'Just now';
        if (diffInSeconds < 3600) return `${Math.floor(diffInSeconds / 60)}m ago`;
        if (diffInSeconds < 86400) return `${Math.floor(diffInSeconds / 3600)}h ago`;
        return `${Math.floor(diffInSeconds / 86400)}d ago`;
    }

    function copyToClipboard(text) {
        navigator.clipboard.writeText(text).then(() => {
            showToast('Copied to clipboard!', 'success');
        });
    }

    function showToast(message, type = 'info') {
        const toast = document.createElement('div');
        toast.className = `fixed top-4 right-4 z-50 px-6 py-4 rounded-lg text-white ${
            type === 'success' ? 'bg-green-500' : 
            type === 'error' ? 'bg-red-500' : 
            type === 'warning' ? 'bg-yellow-500' : 'bg-blue-500'
        }`;
        toast.textContent = message;
        
        document.body.appendChild(toast);
        setTimeout(() => toast.remove(), 3000);
    }

    // API Key Management Functions
    function generateAPIKey() {
        showToast('API Key generation modal would open here', 'info');
    }

    function createAPIKey() {
        showToast('Creating new API key...', 'info');
        setTimeout(() => {
            showToast('API key created successfully!', 'success');
        }, 2000);
    }

    function viewAPIKey(id) {
        showToast(`Viewing API key ${id}`, 'info');
    }

    function regenerateKey(id) {
        if (confirm('Regenerate this API key? The old key will stop working immediately.')) {
            showToast(`Regenerating API key ${id}...`, 'warning');
        }
    }

    function revokeKey(id) {
        if (confirm('Revoke this API key? This cannot be undone.')) {
            showToast(`API key ${id} revoked`, 'warning');
        }
    }

    function deleteKey(id) {
        if (confirm('Delete this API key? This cannot be undone.')) {
            showToast(`API key ${id} deleted`, 'error');
        }
    }

    // Other functions
    function testAPI() {
        showToast('API testing interface would open here', 'info');
    }

    function downloadSDK() {
        showToast('Downloading SDK...', 'info');
    }

    function toggleEndpointDetails(index) {
        const details = document.getElementById(`endpoint-details-${index}`);
        details.classList.toggle('hidden');
    }

    function testEndpoint(method, path) {
        showToast(`Testing ${method} ${path}...`, 'info');
    }

    function generateCode(method, path) {
        showToast(`Generating code for ${method} ${path}...`, 'info');
    }

    function toggleScope(scopeId) {
        const selector = document.querySelector(`[data-scope="${scopeId}"]`);
        const checkbox = document.getElementById(`scope-${scopeId}`);
        
        selector.classList.toggle('selected');
        checkbox.checked = !checkbox.checked;
    }

    // Make functions globally available
    window.switchTab = switchTab;
    window.generateAPIKey = generateAPIKey;
    window.createAPIKey = createAPIKey;
    window.testAPI = testAPI;
    window.downloadSDK = downloadSDK;
    window.viewAPIKey = viewAPIKey;
    window.regenerateKey = regenerateKey;
    window.revokeKey = revokeKey;
    window.deleteKey = deleteKey;
    window.toggleEndpointDetails = toggleEndpointDetails;
    window.testEndpoint = testEndpoint;
    window.generateCode = generateCode;
    window.toggleScope = toggleScope;
    window.copyToClipboard = copyToClipboard;

</script>

</body>
</html>