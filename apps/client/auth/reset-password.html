<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Reset Password | ADD Physical Products</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body { font-family: 'Inter', sans-serif; }
    .brand { color: #0e2038; }
    @media (max-width: 900px) {
      .auth-cols { flex-direction: column; }
      .auth-left, .auth-right { width: 100% !important; min-width: 0; }
      .auth-left { border-radius: 1.5rem 1.5rem 0 0; }
      .auth-right { border-radius: 0 0 1.5rem 1.5rem; }
    }
  </style>
</head>
<body class="min-h-screen flex items-center justify-center bg-gray-50">
  <main class="w-full max-w-4xl mx-auto flex auth-cols rounded-2xl shadow-lg overflow-hidden bg-white" style="min-height: 500px;">
    <!-- LEFT: Welcome, Illustration, Icon -->
    <section class="auth-left flex flex-col justify-center items-center p-8 gap-6" style="width:44%; min-width:320px; background:linear-gradient(135deg,#0e2038 0%,#1a2e4a 50%,#314b75 100%);">
      <div class="icon-bg p-4 mb-2 flex items-center justify-center">
        <!-- SVG fallback -->
        <svg width="64" height="64" viewBox="0 0 64 64" fill="none" class="absolute z-0"><circle cx="32" cy="32" r="32" fill="#e5e9f2"/><path d="M32 20a12 12 0 1 1 0 24a12 12 0 0 1 0-24z" stroke="#0e2038" stroke-width="2"/><rect x="24" y="36" width="16" height="8" rx="2" fill="#0e2038" opacity=".15"/></svg>
        <!-- Lottie Animation: Password Reset -->
        <div class="w-28 h-28 flex items-center justify-center relative z-10">
          <lottie-player src="https://assets2.lottiefiles.com/packages/lf20_4kx2q32n.json" background="transparent" speed="1" style="width:100px;height:100px;" loop autoplay></lottie-player>
        </div>
      </div>
      <h2 class="text-2xl font-extrabold text-white mb-2 text-center">Reset your password</h2>
      <p class="text-base text-center text-white">Enter your new password below. Make sure it's strong and unique to keep your account secure.</p>
    </section>
    <!-- RIGHT: Form -->
    <section class="auth-right flex flex-col justify-center items-center p-8 gap-4" style="width:56%; min-width:320px; background:#fff;">
      <div class="flex items-center gap-2 mb-4">
        <img src="/public/images/logo.png" alt="ADD Physical Product Logo" class="h-12 w-12 rounded-xl shadow bg-white" />
        <span class="font-extrabold text-xl tracking-tight brand">ADD Physical Products</span>
      </div>
      <div class="w-full max-w-sm">
        <form id="reset-password-form" class="flex flex-col gap-4" autocomplete="on" method="POST" action="#">
          <label for="password" class="brand font-semibold">New Password</label>
          <input id="password" name="password" type="password" required pattern=".{8,}" title="Password must be at least 8 characters long" minlength="6" class="px-4 py-2 border border-[#0e2038] rounded focus:ring-2 focus:ring-[#0e2038] outline-none" />
          <label for="confirm-password" class="brand font-semibold">Confirm Password</label>
          <input id="confirm-password" name="confirm-password" type="password" required pattern=".{8,}" title="Password must be at least 8 characters long" minlength="6" class="px-4 py-2 border border-[#0e2038] rounded focus:ring-2 focus:ring-[#0e2038] outline-none" />
          <button id="reset-password-btn" type="submit" class="w-full py-2 rounded font-bold mt-2 flex items-center justify-center gap-2" style="background:linear-gradient(90deg,#0e2038 0%,#23325c 100%);color:#fff;">
            <span>Reset Password</span>
            <svg id="reset-password-spinner" class="animate-spin h-5 w-5 text-white ml-2" style="display:none;" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"></path></svg>
          </button>
        </form>
        <div id="reset-password-success" class="text-green-600 text-sm mt-2" style="display:none;"></div>
        <div id="reset-password-error" class="text-red-600 text-sm mt-2" style="display:none;"></div>
        <div class="mt-4 text-center">
          <a href="/auth/auth-buyer.html" class="brand hover:underline">Back to Login</a>
        </div>
      </div>
    </section>
  </main>
  <script defer src="https://unpkg.com/@lottiefiles/lottie-player@latest/dist/lottie-player.js"></script>
  <script>
  // AJAX Reset Password
  document.addEventListener('DOMContentLoaded', function() {
    const form = document.getElementById('reset-password-form');
    if (!form) return;
    form.onsubmit = async function(e) {
      e.preventDefault();
      const btn = document.getElementById('reset-password-btn');
      const spinner = document.getElementById('reset-password-spinner');
      const successDiv = document.getElementById('reset-password-success');
      const errorDiv = document.getElementById('reset-password-error');
      successDiv.style.display = 'none';
      errorDiv.style.display = 'none';
      btn.disabled = true;
      spinner.style.display = '';
      btn.querySelector('span').textContent = 'Resetting...';
      const password = form.password.value;
      const confirmPassword = form["confirm-password"].value;
      if (password !== confirmPassword) {
        errorDiv.textContent = 'Passwords do not match.';
        errorDiv.style.display = '';
        btn.disabled = false;
        spinner.style.display = 'none';
        btn.querySelector('span').textContent = 'Reset Password';
        return;
      }
      try {
        // Assume token is in URL as ?token=...
        const urlParams = new URLSearchParams(window.location.search);
        const token = urlParams.get('token');
        if (!token) throw new Error('Invalid or missing reset token.');
        const res = await fetch('/api/auth/reset-password', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ password, token })
        });
        const data = await res.json();
        if (!res.ok) throw new Error(data.error || 'Failed to reset password');
        successDiv.textContent = 'Your password has been reset. You can now log in.';
        successDiv.style.display = '';
        btn.querySelector('span').textContent = 'Success!';
      } catch (err) {
        errorDiv.textContent = err.message;
        errorDiv.style.display = '';
        btn.disabled = false;
        spinner.style.display = 'none';
        btn.querySelector('span').textContent = 'Reset Password';
      }
    };
  });
  </script>

<script>
// Utility Functions for Enhanced Functionality
function showNotification(message, type = 'info') {
    // Create notification element
    const notification = document.createElement('div');
    notification.className = `fixed top-4 right-4 z-50 p-4 rounded-lg shadow-lg transition-all duration-300 ${
        type === 'success' ? 'bg-green-500 text-white' :
        type === 'error' ? 'bg-red-500 text-white' :
        type === 'warning' ? 'bg-yellow-500 text-black' :
        'bg-blue-500 text-white'
    }`;
    notification.textContent = message;
    
    document.body.appendChild(notification);
    
    // Remove after 3 seconds
    setTimeout(() => {
        notification.style.opacity = '0';
        setTimeout(() => notification.remove(), 300);
    }, 3000);
}

// Generic search handlers
function handleProductSearch(query) {
    console.log('Searching products:', query);
    if (query.length > 2) {
        // Implement product search logic
        showNotification('Searching for: ' + query, 'info');
    }
}

function handleSellerSearch(query) {
    console.log('Searching sellers:', query);
    if (query.length > 2) {
        showNotification('Searching sellers: ' + query, 'info');
    }
}

function handleAgentSearch(query) {
    console.log('Searching agents:', query);
    if (query.length > 2) {
        showNotification('Searching agents: ' + query, 'info');
    }
}

function handleOrderSearch(query) {
    console.log('Searching orders:', query);
    if (query.length > 2) {
        showNotification('Searching orders: ' + query, 'info');
    }
}

function handleUserSearch(query) {
    console.log('Searching users:', query);
    if (query.length > 2) {
        showNotification('Searching users: ' + query, 'info');
    }
}

// Generic form handlers
function handleSave() {
    showNotification('Save functionality will be implemented soon', 'info');
}

function handleEdit() {
    showNotification('Edit functionality will be implemented soon', 'info');
}

function handleDelete() {
    if (confirm('Are you sure you want to delete this item?')) {
        showNotification('Delete functionality will be implemented soon', 'info');
    }
}

function handleCancel() {
    if (confirm('Are you sure you want to cancel? Unsaved changes will be lost.')) {
        history.back();
    }
}
</script>
</body>
</html> 