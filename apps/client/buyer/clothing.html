<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Clothing & Fashion - ADD Physical Products</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body class="bg-gray-50">
    <!-- Header -->
    <header class="bg-white shadow-sm border-b">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-16">
                <div class="flex items-center">
                    <a href="buyers-home.html" class="text-blue-600 hover:text-blue-800">
                        <i class="fas fa-arrow-left mr-2"></i>Back to Home
                    </a>
                </div>
                <h1 class="text-2xl font-bold text-gray-900">
                    <i class="fas fa-tshirt mr-2 text-pink-600"></i>Clothing & Fashion
                </h1>
                <div class="flex items-center space-x-4">
                    <button id="filterToggle" class="lg:hidden bg-pink-600 text-white px-3 py-2 rounded-lg">
                        <i class="fas fa-filter"></i>
                    </button>
                </div>
            </div>
        </div>
    </header>

    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
        <div class="flex flex-col lg:flex-row gap-8">
            <!-- Filters Sidebar -->
            <div id="filterSidebar" class="lg:w-1/4 space-y-6 hidden lg:block">
                <!-- Sub-category Filter -->
                <div class="bg-white rounded-lg shadow-sm border p-6">
                    <h3 class="text-lg font-semibold text-gray-900 mb-4">Categories</h3>
                    <div id="subcategoryFilters" class="space-y-2">
                        <label class="flex items-center">
                            <input type="radio" name="subcategory" value="" class="mr-2" checked>
                            <span class="text-sm text-gray-700">All Clothing</span>
                        </label>
                        <!-- Subcategories will be loaded here -->
                    </div>
                </div>

                <!-- Size Filter -->
                <div class="bg-white rounded-lg shadow-sm border p-6">
                    <h3 class="text-lg font-semibold text-gray-900 mb-4">Size</h3>
                    <div id="sizeFilters" class="grid grid-cols-3 gap-2">
                        <!-- Size filters will be loaded here -->
                    </div>
                </div>

                <!-- Gender Filter -->
                <div class="bg-white rounded-lg shadow-sm border p-6">
                    <h3 class="text-lg font-semibold text-gray-900 mb-4">Gender</h3>
                    <div id="genderFilters" class="space-y-2">
                        <label class="flex items-center">
                            <input type="radio" name="gender" value="" class="mr-2" checked>
                            <span class="text-sm text-gray-700">All</span>
                        </label>
                        <label class="flex items-center">
                            <input type="radio" name="gender" value="Men" class="mr-2">
                            <span class="text-sm text-gray-700">Men</span>
                        </label>
                        <label class="flex items-center">
                            <input type="radio" name="gender" value="Women" class="mr-2">
                            <span class="text-sm text-gray-700">Women</span>
                        </label>
                        <label class="flex items-center">
                            <input type="radio" name="gender" value="Unisex" class="mr-2">
                            <span class="text-sm text-gray-700">Unisex</span>
                        </label>
                        <label class="flex items-center">
                            <input type="radio" name="gender" value="Kids" class="mr-2">
                            <span class="text-sm text-gray-700">Kids</span>
                        </label>
                    </div>
                </div>

                <!-- Price Filter -->
                <div class="bg-white rounded-lg shadow-sm border p-6">
                    <h3 class="text-lg font-semibold text-gray-900 mb-4">Price Range</h3>
                    <div class="space-y-4">
                        <div class="flex space-x-2">
                            <input type="number" id="minPrice" placeholder="Min" class="w-full px-3 py-2 border border-gray-300 rounded-lg text-sm">
                            <input type="number" id="maxPrice" placeholder="Max" class="w-full px-3 py-2 border border-gray-300 rounded-lg text-sm">
                        </div>
                        <button id="applyPriceFilter" class="w-full bg-pink-600 text-white py-2 rounded-lg hover:bg-pink-700 transition-colors text-sm">
                            Apply
                        </button>
                    </div>
                </div>

                <!-- Color Filter -->
                <div class="bg-white rounded-lg shadow-sm border p-6">
                    <h3 class="text-lg font-semibold text-gray-900 mb-4">Color</h3>
                    <div id="colorFilters" class="space-y-2">
                        <!-- Color filters will be loaded here -->
                    </div>
                </div>

                <!-- Brand Filter -->
                <div class="bg-white rounded-lg shadow-sm border p-6">
                    <h3 class="text-lg font-semibold text-gray-900 mb-4">Brand</h3>
                    <div id="brandFilters" class="space-y-2">
                        <!-- Brand filters will be loaded here -->
                    </div>
                </div>
            </div>

            <!-- Main Content -->
            <div class="lg:w-3/4">
                <!-- Search and Sort -->
                <div class="bg-white rounded-lg shadow-sm border p-6 mb-6">
                    <div class="flex flex-col md:flex-row md:items-center md:justify-between space-y-4 md:space-y-0">
                        <div class="flex-1 max-w-md">
                            <div class="relative">
                                <input type="text" id="searchInput" placeholder="Search clothing..." class="w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-pink-500 focus:border-pink-500">
                                <i class="fas fa-search absolute left-3 top-3 text-gray-400"></i>
                            </div>
                        </div>
                        <div class="flex items-center space-x-4">
                            <select id="sortSelect" class="px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-pink-500 focus:border-pink-500">
                                <option value="created_at:DESC">Newest First</option>
                                <option value="created_at:ASC">Oldest First</option>
                                <option value="price:ASC">Price: Low to High</option>
                                <option value="price:DESC">Price: High to Low</option>
                                <option value="name:ASC">Name: A to Z</option>
                                <option value="name:DESC">Name: Z to A</option>
                            </select>
                            <div class="flex border border-gray-300 rounded-lg">
                                <button id="gridView" class="px-3 py-2 bg-pink-600 text-white rounded-l-lg">
                                    <i class="fas fa-th-large"></i>
                                </button>
                                <button id="listView" class="px-3 py-2 text-gray-600 hover:bg-gray-100 rounded-r-lg">
                                    <i class="fas fa-list"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Results Summary -->
                <div class="mb-6">
                    <p id="resultsCount" class="text-gray-600">Loading products...</p>
                </div>

                <!-- Products Grid -->
                <div id="productsContainer" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                    <!-- Products will be loaded here -->
                </div>

                <!-- Loading State -->
                <div id="loadingState" class="text-center py-12">
                    <div class="animate-spin rounded-full h-12 w-12 border-b-2 border-pink-600 mx-auto mb-4"></div>
                    <p class="text-gray-600">Loading products...</p>
                </div>

                <!-- Empty State -->
                <div id="emptyState" class="text-center py-12 hidden">
                    <i class="fas fa-search text-gray-400 text-4xl mb-4"></i>
                    <p class="text-gray-600 text-lg mb-2">No products found</p>
                    <p class="text-gray-500">Try adjusting your filters or search terms</p>
                </div>

                <!-- Pagination -->
                <div id="pagination" class="mt-8 flex justify-center">
                    <!-- Pagination will be loaded here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Product Detail Modal -->
    <div id="productModal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50">
        <div class="flex items-center justify-center min-h-screen p-4">
            <div class="bg-white rounded-lg shadow-xl max-w-4xl w-full max-h-screen overflow-y-auto">
                <div class="p-6 border-b">
                    <div class="flex justify-between items-center">
                        <h3 class="text-lg font-semibold text-gray-900">Product Details</h3>
                        <button id="closeModal" class="text-gray-400 hover:text-gray-600">
                            <i class="fas fa-times text-xl"></i>
                        </button>
                    </div>
                </div>
                <div id="modalContent" class="p-6">
                    <!-- Product details will be loaded here -->
                </div>
            </div>
        </div>
    </div>

    <script>
        // Global variables
        let currentPage = 1;
        let currentFilters = {
            subcategory: '',
            search: '',
            min_price: '',
            max_price: '',
            sort_by: 'created_at',
            sort_order: 'DESC',
            specifications: {}
        };
        let subcategories = [];
        let isGridView = true;

        // Initialize the page
        document.addEventListener('DOMContentLoaded', function() {
            loadSubcategories();
            loadProducts();
            setupEventListeners();
        });

        // Setup event listeners
        function setupEventListeners() {
            // Filter toggle for mobile
            document.getElementById('filterToggle').addEventListener('click', toggleFilters);
            
            // Search
            document.getElementById('searchInput').addEventListener('input', debounce(handleSearch, 500));
            
            // Sort
            document.getElementById('sortSelect').addEventListener('change', handleSort);
            
            // Price filter
            document.getElementById('applyPriceFilter').addEventListener('click', applyPriceFilter);
            
            // View toggle
            document.getElementById('gridView').addEventListener('click', () => setView('grid'));
            document.getElementById('listView').addEventListener('click', () => setView('list'));
            
            // Modal
            document.getElementById('closeModal').addEventListener('click', closeModal);
            
            // Filter handlers (delegated)
            document.getElementById('subcategoryFilters').addEventListener('change', handleSubcategoryFilter);
            document.getElementById('genderFilters').addEventListener('change', handleGenderFilter);
        }

        // Load subcategories
        async function loadSubcategories() {
            try {
                const response = await fetch('/api/categories/clothing/subcategories');
                const data = await response.json();
                
                if (data.success) {
                    subcategories = data.subcategories;
                    displaySubcategoryFilters(data.subcategories);
                }
            } catch (error) {
                console.error('Error loading subcategories:', error);
            }
        }

        // Display subcategory filters
        function displaySubcategoryFilters(subcategories) {
            const container = document.getElementById('subcategoryFilters');
            
            subcategories.forEach(subcategory => {
                const label = document.createElement('label');
                label.className = 'flex items-center';
                label.innerHTML = `
                    <input type="radio" name="subcategory" value="${subcategory.slug}" class="mr-2">
                    <span class="text-sm text-gray-700">${subcategory.name}</span>
                `;
                container.appendChild(label);
            });
        }

        // Load products
        async function loadProducts() {
            try {
                showLoading();
                
                const params = new URLSearchParams({
                    page: currentPage,
                    limit: 12,
                    ...currentFilters,
                    specifications: JSON.stringify(currentFilters.specifications)
                });

                const response = await fetch(`/api/products/category/clothing?${params}`);
                const data = await response.json();
                
                hideLoading();
                
                if (data.success) {
                    displayProducts(data.products);
                    displayPagination(data.pagination);
                    updateResultsCount(data.pagination.total);
                    loadDynamicFilters(data.products);
                } else {
                    showEmptyState();
                }
            } catch (error) {
                hideLoading();
                console.error('Error loading products:', error);
                showEmptyState();
            }
        }

        // Display products
        function displayProducts(products) {
            const container = document.getElementById('productsContainer');
            
            if (products.length === 0) {
                showEmptyState();
                return;
            }
            
            hideEmptyState();
            container.innerHTML = '';
            
            products.forEach(product => {
                const productCard = createProductCard(product);
                container.appendChild(productCard);
            });
        }

        // Create product card for clothing
        function createProductCard(product) {
            const div = document.createElement('div');
            div.className = 'bg-white rounded-lg shadow-sm border hover:shadow-md transition-shadow cursor-pointer';
            div.onclick = () => showProductModal(product.id);
            
            const specifications = product.specifications || {};
            const brand = specifications.brand || 'Unknown Brand';
            const size = specifications.size || '';
            const color = specifications.color || '';
            const material = specifications.material || '';
            const gender = specifications.gender || '';
            
            div.innerHTML = `
                <div class="aspect-w-16 aspect-h-20 bg-gray-200 rounded-t-lg overflow-hidden">
                    <img src="${product.main_image ? `/uploads/${product.main_image}` : '/placeholder-image.jpg'}" 
                         alt="${product.name}" 
                         class="w-full h-64 object-cover">
                </div>
                <div class="p-4">
                    <div class="flex items-center justify-between mb-2">
                        <span class="text-xs font-medium text-pink-600 bg-pink-100 px-2 py-1 rounded-full">
                            ${product.sub_category_name || 'Clothing'}
                        </span>
                        <span class="text-xs text-gray-500">${brand}</span>
                    </div>
                    <h3 class="text-lg font-semibold text-gray-900 mb-2 line-clamp-2">${product.name}</h3>
                    
                    <!-- Clothing-specific details -->
                    <div class="flex flex-wrap gap-2 mb-3">
                        ${size ? `<span class="text-xs bg-gray-100 text-gray-700 px-2 py-1 rounded">Size: ${size}</span>` : ''}
                        ${color ? `<span class="text-xs bg-gray-100 text-gray-700 px-2 py-1 rounded">${color}</span>` : ''}
                        ${gender ? `<span class="text-xs bg-blue-100 text-blue-700 px-2 py-1 rounded">${gender}</span>` : ''}
                    </div>
                    
                    ${material ? `<p class="text-xs text-gray-600 mb-3">Material: ${material}</p>` : ''}
                    
                    <div class="flex items-center justify-between">
                        <div>
                            <span class="text-2xl font-bold text-gray-900">$${parseFloat(product.price).toFixed(2)}</span>
                            <div class="text-xs text-gray-500">by ${product.seller_name}</div>
                        </div>
                        <button class="bg-pink-600 text-white px-4 py-2 rounded-lg hover:bg-pink-700 transition-colors text-sm">
                            <i class="fas fa-cart-plus mr-1"></i>Add to Cart
                        </button>
                    </div>
                </div>
            `;
            
            return div;
        }

        // Load dynamic filters based on available products
        function loadDynamicFilters(products) {
            loadSizeFilters(products);
            loadColorFilters(products);
            loadBrandFilters(products);
        }

        // Load size filters
        function loadSizeFilters(products) {
            const container = document.getElementById('sizeFilters');
            const sizes = new Set();
            
            products.forEach(product => {
                if (product.specifications && product.specifications.size) {
                    sizes.add(product.specifications.size);
                }
            });
            
            container.innerHTML = '';
            const sizeOrder = ['XS', 'S', 'M', 'L', 'XL', 'XXL', 'XXXL'];
            
            sizeOrder.forEach(size => {
                if (sizes.has(size)) {
                    const button = document.createElement('button');
                    button.className = 'px-3 py-2 border border-gray-300 rounded-lg text-sm hover:bg-pink-50 hover:border-pink-300';
                    button.textContent = size;
                    button.onclick = () => filterBySize(size);
                    container.appendChild(button);
                }
            });
        }

        // Load color filters
        function loadColorFilters(products) {
            const container = document.getElementById('colorFilters');
            const colors = new Set();
            
            products.forEach(product => {
                if (product.specifications && product.specifications.color) {
                    colors.add(product.specifications.color);
                }
            });
            
            container.innerHTML = '';
            Array.from(colors).sort().forEach(color => {
                const label = document.createElement('label');
                label.className = 'flex items-center';
                label.innerHTML = `
                    <input type="checkbox" value="${color}" class="mr-2" onchange="handleColorFilter()">
                    <span class="text-sm text-gray-700">${color}</span>
                `;
                container.appendChild(label);
            });
        }

        // Load brand filters
        function loadBrandFilters(products) {
            const container = document.getElementById('brandFilters');
            const brands = new Set();
            
            products.forEach(product => {
                if (product.specifications && product.specifications.brand) {
                    brands.add(product.specifications.brand);
                }
            });
            
            container.innerHTML = '';
            Array.from(brands).sort().forEach(brand => {
                const label = document.createElement('label');
                label.className = 'flex items-center';
                label.innerHTML = `
                    <input type="checkbox" value="${brand}" class="mr-2" onchange="handleBrandFilter()">
                    <span class="text-sm text-gray-700">${brand}</span>
                `;
                container.appendChild(label);
            });
        }

        // Filter handlers
        function filterBySize(size) {
            currentFilters.specifications.size = size;
            currentPage = 1;
            loadProducts();
        }

        function handleColorFilter() {
            const checkedColors = Array.from(document.querySelectorAll('#colorFilters input:checked')).map(cb => cb.value);
            if (checkedColors.length > 0) {
                currentFilters.specifications.color = checkedColors.join(',');
            } else {
                delete currentFilters.specifications.color;
            }
            currentPage = 1;
            loadProducts();
        }

        function handleBrandFilter() {
            const checkedBrands = Array.from(document.querySelectorAll('#brandFilters input:checked')).map(cb => cb.value);
            if (checkedBrands.length > 0) {
                currentFilters.specifications.brand = checkedBrands.join(',');
            } else {
                delete currentFilters.specifications.brand;
            }
            currentPage = 1;
            loadProducts();
        }

        function handleSubcategoryFilter(event) {
            if (event.target.type === 'radio') {
                currentFilters.subcategory = event.target.value;
                currentPage = 1;
                loadProducts();
            }
        }

        function handleGenderFilter(event) {
            if (event.target.type === 'radio') {
                if (event.target.value) {
                    currentFilters.specifications.gender = event.target.value;
                } else {
                    delete currentFilters.specifications.gender;
                }
                currentPage = 1;
                loadProducts();
            }
        }

        // Handle search
        function handleSearch(event) {
            currentFilters.search = event.target.value;
            currentPage = 1;
            loadProducts();
        }

        // Handle sort
        function handleSort(event) {
            const [sortBy, sortOrder] = event.target.value.split(':');
            currentFilters.sort_by = sortBy;
            currentFilters.sort_order = sortOrder;
            currentPage = 1;
            loadProducts();
        }

        // Apply price filter
        function applyPriceFilter() {
            const minPrice = document.getElementById('minPrice').value;
            const maxPrice = document.getElementById('maxPrice').value;
            
            currentFilters.min_price = minPrice;
            currentFilters.max_price = maxPrice;
            currentPage = 1;
            loadProducts();
        }

        // Show product modal
        async function showProductModal(productId) {
            try {
                const response = await fetch(`/api/products/${productId}`);
                const data = await response.json();
                
                if (data.success) {
                    displayProductModal(data.product);
                    document.getElementById('productModal').classList.remove('hidden');
                }
            } catch (error) {
                console.error('Error loading product details:', error);
            }
        }

        // Display product in modal
        function displayProductModal(product) {
            const modalContent = document.getElementById('modalContent');
            const specifications = product.specifications || {};
            
            modalContent.innerHTML = `
                <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                    <div>
                        <img src="${product.main_image ? `/uploads/${product.main_image}` : '/placeholder-image.jpg'}" 
                             alt="${product.name}" 
                             class="w-full h-80 object-cover rounded-lg">
                        ${product.gallery_images && product.gallery_images.length > 0 ? `
                            <div class="grid grid-cols-4 gap-2 mt-4">
                                ${product.gallery_images.slice(0, 4).map(img => 
                                    `<img src="/uploads/${img}" class="w-full h-20 object-cover rounded border">`
                                ).join('')}
                            </div>
                        ` : ''}
                    </div>
                    <div>
                        <h2 class="text-2xl font-bold text-gray-900 mb-4">${product.name}</h2>
                        <p class="text-gray-600 mb-6">${product.description}</p>
                        
                        <div class="space-y-4 mb-6">
                            <div class="flex justify-between">
                                <span class="text-gray-600">Price:</span>
                                <span class="text-2xl font-bold text-pink-600">$${parseFloat(product.price).toFixed(2)}</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-600">Seller:</span>
                                <span class="font-medium">${product.seller_name}</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-600">Stock:</span>
                                <span class="font-medium">${product.stock_quantity} available</span>
                            </div>
                        </div>
                        
                        <!-- Clothing Details -->
                        <div class="border-t pt-6">
                            <h3 class="text-lg font-semibold text-gray-900 mb-4">Product Details</h3>
                            <div class="grid grid-cols-2 gap-4">
                                ${specifications.size ? `
                                    <div>
                                        <span class="text-sm text-gray-600">Size:</span>
                                        <span class="text-sm font-medium text-gray-900 ml-2">${specifications.size}</span>
                                    </div>
                                ` : ''}
                                ${specifications.color ? `
                                    <div>
                                        <span class="text-sm text-gray-600">Color:</span>
                                        <span class="text-sm font-medium text-gray-900 ml-2">${specifications.color}</span>
                                    </div>
                                ` : ''}
                                ${specifications.material ? `
                                    <div>
                                        <span class="text-sm text-gray-600">Material:</span>
                                        <span class="text-sm font-medium text-gray-900 ml-2">${specifications.material}</span>
                                    </div>
                                ` : ''}
                                ${specifications.gender ? `
                                    <div>
                                        <span class="text-sm text-gray-600">Gender:</span>
                                        <span class="text-sm font-medium text-gray-900 ml-2">${specifications.gender}</span>
                                    </div>
                                ` : ''}
                                ${specifications.brand ? `
                                    <div>
                                        <span class="text-sm text-gray-600">Brand:</span>
                                        <span class="text-sm font-medium text-gray-900 ml-2">${specifications.brand}</span>
                                    </div>
                                ` : ''}
                                ${specifications.fit_type ? `
                                    <div>
                                        <span class="text-sm text-gray-600">Fit:</span>
                                        <span class="text-sm font-medium text-gray-900 ml-2">${specifications.fit_type}</span>
                                    </div>
                                ` : ''}
                            </div>
                            
                            ${specifications.care_instructions ? `
                                <div class="mt-4">
                                    <span class="text-sm text-gray-600">Care Instructions:</span>
                                    <p class="text-sm text-gray-900 mt-1">${specifications.care_instructions}</p>
                                </div>
                            ` : ''}
                        </div>
                        
                        <div class="flex space-x-4 mt-8">
                            <button class="flex-1 bg-pink-600 text-white py-3 rounded-lg hover:bg-pink-700 transition-colors">
                                <i class="fas fa-cart-plus mr-2"></i>Add to Cart
                            </button>
                            <button class="flex-1 bg-gray-200 text-gray-800 py-3 rounded-lg hover:bg-gray-300 transition-colors">
                                <i class="fas fa-heart mr-2"></i>Add to Wishlist
                            </button>
                        </div>
                    </div>
                </div>
            `;
        }

        // Close modal
        function closeModal() {
            document.getElementById('productModal').classList.add('hidden');
        }

        // Display pagination
        function displayPagination(pagination) {
            const container = document.getElementById('pagination');
            
            if (pagination.pages <= 1) {
                container.innerHTML = '';
                return;
            }
            
            let paginationHTML = '';
            
            // Previous button
            if (pagination.page > 1) {
                paginationHTML += `
                    <button onclick="changePage(${pagination.page - 1})" class="px-3 py-2 border border-gray-300 rounded-l-lg hover:bg-gray-50">
                        <i class="fas fa-chevron-left"></i>
                    </button>
                `;
            }
            
            // Page numbers
            const startPage = Math.max(1, pagination.page - 2);
            const endPage = Math.min(pagination.pages, pagination.page + 2);
            
            for (let i = startPage; i <= endPage; i++) {
                paginationHTML += `
                    <button onclick="changePage(${i})" class="px-3 py-2 border-t border-b border-gray-300 ${
                        i === pagination.page ? 'bg-pink-600 text-white' : 'hover:bg-gray-50'
                    }">
                        ${i}
                    </button>
                `;
            }
            
            // Next button
            if (pagination.page < pagination.pages) {
                paginationHTML += `
                    <button onclick="changePage(${pagination.page + 1})" class="px-3 py-2 border border-gray-300 rounded-r-lg hover:bg-gray-50">
                        <i class="fas fa-chevron-right"></i>
                    </button>
                `;
            }
            
            container.innerHTML = `<div class="flex">${paginationHTML}</div>`;
        }

        // Change page
        function changePage(page) {
            currentPage = page;
            loadProducts();
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        // Update results count
        function updateResultsCount(total) {
            document.getElementById('resultsCount').textContent = `Showing ${total} clothing products`;
        }

        // Toggle filters on mobile
        function toggleFilters() {
            const sidebar = document.getElementById('filterSidebar');
            sidebar.classList.toggle('hidden');
        }

        // Set view mode
        function setView(viewMode) {
            isGridView = viewMode === 'grid';
            
            const gridBtn = document.getElementById('gridView');
            const listBtn = document.getElementById('listView');
            const container = document.getElementById('productsContainer');
            
            if (isGridView) {
                gridBtn.className = 'px-3 py-2 bg-pink-600 text-white rounded-l-lg';
                listBtn.className = 'px-3 py-2 text-gray-600 hover:bg-gray-100 rounded-r-lg';
                container.className = 'grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6';
            } else {
                gridBtn.className = 'px-3 py-2 text-gray-600 hover:bg-gray-100 rounded-l-lg';
                listBtn.className = 'px-3 py-2 bg-pink-600 text-white rounded-r-lg';
                container.className = 'space-y-4';
            }
            
            loadProducts(); // Reload to apply new layout
        }

        // Utility functions
        function showLoading() {
            document.getElementById('loadingState').classList.remove('hidden');
            document.getElementById('productsContainer').classList.add('hidden');
        }

        function hideLoading() {
            document.getElementById('loadingState').classList.add('hidden');
            document.getElementById('productsContainer').classList.remove('hidden');
        }

        function showEmptyState() {
            document.getElementById('emptyState').classList.remove('hidden');
            document.getElementById('productsContainer').classList.add('hidden');
        }

        function hideEmptyState() {
            document.getElementById('emptyState').classList.add('hidden');
            document.getElementById('productsContainer').classList.remove('hidden');
        }

        function debounce(func, wait) {
            let timeout;
            return function executedFunction(...args) {
                const later = () => {
                    clearTimeout(timeout);
                    func(...args);
                };
                clearTimeout(timeout);
                timeout = setTimeout(later, wait);
            };
        }
    </script>
</body>
</html>